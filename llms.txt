# stablehlo

The {stablehlo} R package provides a functional API to create
[stableHLO](https://openxla.org/stablehlo) programs. These programs can
be executed using the R package [pjrt](https://github.com/r-xla/pjrt).

## Installation

From GitHub:

``` r
pak::pak("r-xla/stablehlo")
```

You can also install from
[r-universe](https://r-xla.r-universe.dev/builds), by adding the code
below to your `.Rprofile`.

``` r
options(repos = c(
  rxla = "https://r-xla.r-universe.dev",
  CRAN = "https://cloud.r-project.org/"
))
```

## Quickstart

Below, we create a function that takes two input arguments `x` and `y`
of type `f32` and shape `(2, 2)` and adds them. Passing `func` to
[`hlo_input()`](reference/hlo_input.md) is optional, because it will
automatically use the last function created with
[`hlo_func()`](reference/hlo_func.md).

``` r
library(stablehlo)
func <- hlo_func("myfn")
func
#> func.func @myfn () ->  {
#> 
#> }
x <- hlo_input("x", "f32", shape = c(2, 2), func = func)
x
#> Variable %x in:
#> func.func @myfn (%x: tensor<2x2xf32>) ->  {
#> 
#> }
y <- hlo_input("y", "f32", shape = c(2, 2), func = func)
y
#> Variable %y in:
#> func.func @myfn (%x: tensor<2x2xf32>, %y: tensor<2x2xf32>) ->  {
#> 
#> }
z <- hlo_add(x, y)
z
#> Variable %0 in:
#> func.func @myfn (%x: tensor<2x2xf32>, %y: tensor<2x2xf32>) ->  {
#> %0 = "stablehlo.add" (%x, %y): (tensor<2x2xf32>, tensor<2x2xf32>) -> (tensor<2x2xf32>)
#> }
f <- hlo_return(z)
identical(f, func)
#> [1] TRUE
f
#> func.func @myfn (%x: tensor<2x2xf32>, %y: tensor<2x2xf32>) -> tensor<2x2xf32> {
#> %0 = "stablehlo.add" (%x, %y): (tensor<2x2xf32>, tensor<2x2xf32>) -> (tensor<2x2xf32>)
#> "func.return"(%0): (tensor<2x2xf32>) -> ()
#> }
```

## Main Features

- Implements type inference to easily build up stableHLO programs.
- Simple, functional API.
- Clear error messages.
- Easy installation because the implementation is in R and does not
  depend on the stableHLO C++ builder, which depends on LLVM and MLIR.

## Important notes

stableHLO uses 0-based indexing. Wherever operations take dimension
indices (e.g., axes, start indices, permutation dimensions), use 0-based
values. This differs from R’s 1-based indexing.

## Limitations

The R package is a *partial* implementation of the stableHLO
specification. At least initially, it will:

- only support a subset of the available operations, see [this
  issue](https://github.com/r-xla/stablehlo/issues/6) for an overview.
- not support all data types, e.g. quantized types and complex numbers
  are not supported.
- not support shape dynamism.

## Acknowledgments

- This work is supported by [MaRDI](https://www.mardi4nfdi.de).
- This work is built upon the [stableHLO
  specification](https://openxla.org/stablehlo/spec) from the OpenXLA
  project.

# Package index

## All functions

- [`BoolAttr()`](BoolAttr.md) : BoolAttr
- [`BooleanType()`](BooleanType.md) : BooleanType
- [`Constant()`](Constant.md) : Constant
- [`ConstantAttr()`](ConstantAttr.md) : ConstantAttr
- [`CustomOpBackendConfig()`](CustomOpBackendConfig.md) :
  CustomOpBackendConfig
- [`DotDimensionNumbers()`](DotDimensionNumbers.md) :
  DotDimensionNumbers
- [`FloatType()`](FloatType.md) : FloatType
- [`Func()`](Func.md) : Func
- [`FuncBody()`](FuncBody.md) : FuncBody
- [`FuncId()`](FuncId.md) : FuncId
- [`FuncInput()`](FuncInput.md) : FuncInput
- [`FuncInputs()`](FuncInputs.md) : FuncInputs
- [`FuncOutput()`](FuncOutput.md) : FuncOutput
- [`FuncOutputs()`](FuncOutputs.md) : FuncOutputs
- [`FuncValue()`](FuncValue.md) : FuncValue
- [`IntegerType()`](IntegerType.md) : IntegerType (signed)
- [`Op()`](Op.md) : Op
- [`OpInputAttr()`](OpInputAttr.md) : OpInputAttr
- [`OpInputAttrs()`](OpInputAttrs.md) : OpInputAttrs
- [`OpInputFunc()`](OpInputFunc.md) : OpInputFunc
- [`OpInputFuncs()`](OpInputFuncs.md) : OpInputFuncs
- [`OpInputValue()`](OpInputValue.md) : OpInputValue
- [`OpInputValues()`](OpInputValues.md) : OpInputValues
- [`OpInputs()`](OpInputs.md) : OpInputs
- [`OpName()`](OpName.md) : OpName
- [`OpOutput()`](OpOutput.md) : OpOutput
- [`OpOutputs()`](OpOutputs.md) : OpOutputs
- [`OpSignature()`](OpSignature.md) : OpSignature
- [`ScalarAttr()`](ScalarAttr.md) : ScalarAttr
- [`Shape()`](Shape.md) : Shape
- [`StringAttr()`](StringAttr.md) : StringAttr
- [`TensorDataType`](TensorDataType.md) : TensorDataType Base Class
- [`TensorType()`](TensorType.md) : TensorType
- [`UnsignedType()`](UnsignedType.md) : UnsignedType
- [`ValueId()`](ValueId.md) : ValueId
- [`ValueType()`](ValueType.md) : ValueType
- [`ValueTypes()`](ValueTypes.md) : ValueTypes
- [`as_dtype()`](as_dtype.md) : Convert to TensorDataType
- [`constant_attr()`](constant_attr.md) : Create a ConstantAttr from R
  values
- [`.current_func()`](dot-current_func.md) : Get the last function
  created
- [`error_dimension_uniqueness()`](error_dimension_uniqueness.md) :
  ErrorDimensionUniqueness
- [`error_index_out_of_bounds()`](error_index_out_of_bounds.md) :
  ErrorIndexOutOfBounds
- [`error_permute_index()`](error_permute_index.md) : ErrorPermuteIndex
- [`error_stablehlo()`](error_stablehlo.md) : ErrorStablehlo
- [`error_unequal_types()`](error_unequal_types.md) : ErrorUnequalTypes
- [`error_unexpected_type()`](error_unexpected_type.md) :
  ErrorUnexpectedType
- [`format_double()`](format_double.md) : Format Double Array with
  Scientific Notation
- [`infer_types_abs()`](hlo_abs.md) [`hlo_abs()`](hlo_abs.md) : Abs
  Operator
- [`infer_types_add()`](hlo_add.md) [`hlo_add()`](hlo_add.md) : Add
  Operator
- [`infer_types_after_all()`](hlo_after_all.md)
  [`hlo_after_all()`](hlo_after_all.md) : AfterAll Operator
- [`infer_types_and()`](hlo_and.md) [`hlo_and()`](hlo_and.md) : And
  Operator
- [`infer_types_atan2()`](hlo_atan2.md) [`hlo_atan2()`](hlo_atan2.md) :
  Atan2 Operator
- [`infer_types_bitcast_convert()`](hlo_bitcast_convert.md)
  [`hlo_bitcast_convert()`](hlo_bitcast_convert.md) : BitcastConvert
  Operator
- [`infer_types_broadcast_in_dim()`](hlo_broadcast_in_dim.md)
  [`hlo_broadcast_in_dim()`](hlo_broadcast_in_dim.md) : BroadcastInDim
  Operator
- [`infer_types_case()`](hlo_case.md) [`hlo_case()`](hlo_case.md) : Case
  Operator
- [`infer_types_cbrt()`](hlo_cbrt.md) [`hlo_cbrt()`](hlo_cbrt.md) : Cbrt
  Operator
- [`infer_types_ceil()`](hlo_ceil.md) [`hlo_ceil()`](hlo_ceil.md) : Ceil
  Operator
- [`hlo_cholesky()`](hlo_cholesky.md) : Cholesky Operator
- [`infer_types_clamp()`](hlo_clamp.md) [`hlo_clamp()`](hlo_clamp.md) :
  Clamp Operator
- [`hlo_closure()`](hlo_closure.md) : Create a Closure
- [`infer_types_compare()`](hlo_compare.md)
  [`hlo_compare()`](hlo_compare.md) : Compare Operator
- [`infer_types_concatenate()`](hlo_concatenate.md)
  [`hlo_concatenate()`](hlo_concatenate.md) : Concatenate Operator
- [`hlo_scalar()`](hlo_constant.md) [`hlo_tensor()`](hlo_constant.md)
  [`hlo_empty()`](hlo_constant.md)
  [`infer_types_constant()`](hlo_constant.md) : Create a Constant
- [`infer_types_convert()`](hlo_convert.md)
  [`hlo_convert()`](hlo_convert.md) : Convert Operator
- [`infer_types_cosine()`](hlo_cosine.md)
  [`hlo_cosine()`](hlo_cosine.md) : Cosine Operator
- [`infer_types_count_leading_zeros()`](hlo_count_leading_zeros.md)
  [`hlo_count_leading_zeros()`](hlo_count_leading_zeros.md) :
  CountLeadingZeros Operator
- [`hlo_custom_call()`](hlo_custom_call.md) : Custom Call Operation
- [`infer_types_divide()`](hlo_divide.md)
  [`hlo_divide()`](hlo_divide.md) : Divide Operator
- [`infer_types_dot_general()`](hlo_dot_general.md)
  [`hlo_dot_general()`](hlo_dot_general.md) : DotGeneral Operator
- [`infer_types_dynamic_slice()`](hlo_dynamic_slice.md)
  [`hlo_dynamic_slice()`](hlo_dynamic_slice.md) : DynamicSlice Operator
- [`infer_types_dynamic_update_slice()`](hlo_dynamic_update_slice.md)
  [`hlo_dynamic_update_slice()`](hlo_dynamic_update_slice.md) :
  DynamicUpdateSlice Operator
- [`infer_types_exponential()`](hlo_exponential.md)
  [`hlo_exponential()`](hlo_exponential.md) : Exponential Operator
- [`infer_types_exponential_minus_one()`](hlo_exponential_minus_one.md)
  [`hlo_exponential_minus_one()`](hlo_exponential_minus_one.md) :
  ExponentialMinusOne Operator
- [`infer_types_floor()`](hlo_floor.md) [`hlo_floor()`](hlo_floor.md) :
  Floor Operator
- [`hlo_func()`](hlo_func.md) [`local_func()`](hlo_func.md) : Create a
  function
- [`infer_types_if()`](hlo_if.md) [`hlo_if()`](hlo_if.md) : If Operator
- [`hlo_input()`](hlo_input.md) : Create a input to a function
- [`infer_types_iota()`](hlo_iota.md) [`hlo_iota()`](hlo_iota.md) : Iota
  Operator
- [`infer_types_is_finite()`](hlo_is_finite.md)
  [`hlo_is_finite()`](hlo_is_finite.md) : IsFinite Operator
- [`infer_types_log()`](hlo_log.md) [`hlo_log()`](hlo_log.md) : Log
  Operator
- [`infer_types_log_plus_one()`](hlo_log_plus_one.md)
  [`hlo_log_plus_one()`](hlo_log_plus_one.md) : LogPlusOne Operator
- [`infer_types_logistic()`](hlo_logistic.md)
  [`hlo_logistic()`](hlo_logistic.md) : Logistic Operator
- [`infer_types_maximum()`](hlo_maximum.md)
  [`hlo_maximum()`](hlo_maximum.md) : Maximum Operator
- [`infer_types_minimum()`](hlo_minimum.md)
  [`hlo_minimum()`](hlo_minimum.md) : Minimum Operator
- [`infer_types_multiply()`](hlo_multiply.md)
  [`hlo_multiply()`](hlo_multiply.md) : Multiply Operator
- [`infer_types_negate()`](hlo_negate.md)
  [`hlo_negate()`](hlo_negate.md) : Negate Operator
- [`infer_types_not()`](hlo_not.md) [`hlo_not()`](hlo_not.md) : Not
  Operator
- [`infer_types_or()`](hlo_or.md) [`hlo_or()`](hlo_or.md) : Or Operator
- [`infer_types_pad()`](hlo_pad.md) [`hlo_pad()`](hlo_pad.md) : Pad
  Operator
- [`infer_types_popcnt()`](hlo_popcnt.md)
  [`hlo_popcnt()`](hlo_popcnt.md) : Popcnt Operator
- [`infer_types_power()`](hlo_power.md) [`hlo_power()`](hlo_power.md) :
  Power Operator
- [`infer_types_reduce()`](hlo_reduce.md)
  [`hlo_reduce()`](hlo_reduce.md) : Reduce Operator
- [`infer_types_reduce_window()`](hlo_reduce_window.md)
  [`hlo_reduce_window()`](hlo_reduce_window.md) : ReduceWindow Operator
- [`infer_types_remainder()`](hlo_remainder.md)
  [`hlo_remainder()`](hlo_remainder.md) : Remainder Operator
- [`infer_types_reshape()`](hlo_reshape.md)
  [`hlo_reshape()`](hlo_reshape.md) : Reshape Operator
- [`infer_types_return()`](hlo_return.md)
  [`hlo_return()`](hlo_return.md) : Return Values
- [`infer_types_reverse()`](hlo_reverse.md)
  [`hlo_reverse()`](hlo_reverse.md) : Reverse Operator
- [`infer_types_rng_bit_generator()`](hlo_rng_bit_generator.md)
  [`hlo_rng_bit_generator()`](hlo_rng_bit_generator.md) :
  RngBitGenerator Operator
- [`infer_types_round_nearest_afz()`](hlo_round_nearest_afz.md)
  [`hlo_round_nearest_afz()`](hlo_round_nearest_afz.md) :
  RoundNearestAfz Operator
- [`infer_types_round_nearest_even()`](hlo_round_nearest_even.md)
  [`hlo_round_nearest_even()`](hlo_round_nearest_even.md) :
  RoundNearestEven Operator
- [`infer_types_rsqrt()`](hlo_rsqrt.md) [`hlo_rsqrt()`](hlo_rsqrt.md) :
  Rsqrt Operator
- [`infer_types_select()`](hlo_select.md)
  [`hlo_select()`](hlo_select.md) : Select Operator
- [`infer_types_shift_left()`](hlo_shift_left.md)
  [`hlo_shift_left()`](hlo_shift_left.md) : ShiftLeft Operator
- [`infer_types_shift_right_arithmetic()`](hlo_shift_right_arithmetic.md)
  [`hlo_shift_right_arithmetic()`](hlo_shift_right_arithmetic.md) :
  ShiftRightArithmetic Operator
- [`infer_types_shift_right_logical()`](hlo_shift_right_logical.md)
  [`hlo_shift_right_logical()`](hlo_shift_right_logical.md) :
  ShiftRightLogical Operator
- [`infer_types_sign()`](hlo_sign.md) [`hlo_sign()`](hlo_sign.md) : Sign
  Operator
- [`infer_types_sine()`](hlo_sine.md) [`hlo_sine()`](hlo_sine.md) : Sine
  Operator
- [`infer_types_slice()`](hlo_slice.md) [`hlo_slice()`](hlo_slice.md) :
  Slice Operator
- [`infer_types_sort()`](hlo_sort.md) [`hlo_sort()`](hlo_sort.md) : Sort
  Operator
- [`infer_types_sqrt()`](hlo_sqrt.md) [`hlo_sqrt()`](hlo_sqrt.md) : Sqrt
  Operator
- [`infer_types_subtract()`](hlo_subtract.md)
  [`hlo_subtract()`](hlo_subtract.md) : Subtract Operator
- [`infer_types_tan()`](hlo_tan.md) [`hlo_tan()`](hlo_tan.md) : Tan
  Operator
- [`infer_types_tanh()`](hlo_tanh.md) [`hlo_tanh()`](hlo_tanh.md) : Tanh
  Operator
- [`infer_types_transpose()`](hlo_transpose.md)
  [`hlo_transpose()`](hlo_transpose.md) : Transpose Operator
- [`infer_types_triangular_solve()`](hlo_triangular_solve.md)
  [`hlo_triangular_solve()`](hlo_triangular_solve.md) : TriangularSolve
  Operator
- [`infer_types_while()`](hlo_while.md) [`hlo_while()`](hlo_while.md) :
  While Operator
- [`infer_types_xor()`](hlo_xor.md) [`hlo_xor()`](hlo_xor.md) : Xor
  Operator
- [`infer_types_custom_call()`](infer_types_custom_call.md) : Infer
  types for custom call
- [`infer_types_float_biv()`](infer_types_float_biv.md) : Infer types
  for float binary operations
- [`infer_types_float_uni()`](infer_types_float_uni.md) : Infer types
  for float unary operations
- [`infer_types_generic_biv()`](infer_types_generic_biv.md) : Infer
  types for binary operations
- [`infer_types_generic_uni()`](infer_types_generic_uni.md) : Infer
  types for unary operations
- [`infer_types_integer_uni()`](infer_types_integer_uni.md) : Infer
  types for integer unary operations
- [`infer_types_integerish_biv()`](infer_types_integerish_biv.md) :
  Infer types for boolean integerish operations
- [`infer_types_integerish_uni()`](infer_types_integerish_uni.md) :
  Infer types for integerish unary operations
- [`infer_types_numeric_biv()`](infer_types_numeric_biv.md) : Infer
  types for numeric binary operations
- [`infer_types_numeric_uni()`](infer_types_numeric_uni.md) : Infer
  types for numeric unary operations
- [`is_dtype()`](is_dtype.md) : Is TensorDataType
- [`r_to_constant()`](r_to_constant.md) : Convert R value to Constant
- [`repr()`](repr.md) : Generate string representation for object
- [`to_one_based()`](to_one_based.md) : Convert 0-based indices to
  1-based

# Articles

### All vignettes

- [Get Started](stablehlo.md):
